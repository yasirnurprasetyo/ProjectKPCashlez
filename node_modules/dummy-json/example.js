const fecha = require('fecha');
const dummyjson = require('./index');

const myMockdata = {
  direction: ['Left', 'Right'],
  animals: ['cat', 'dog', 'pig'],
};

const myHelpers = {
  dateNow: function() {
    const now = Date.now();
    return fecha.format(now, 'YYYY-MM-DD HH:mm');
  },
  orientation() {
    console.log(this)
    return dummyjson.utils.randomArrayItem(['North', 'South', 'East', 'West']);
  }
};

const template = `{
  "users": [
    {{#repeat 2}}
    {
      "id": {{@index}},
      "code": {{add (step 10) 100}},
      "name": "{{firstName}} {{lastName}}",
      "work": "{{company}}",
      "email": "{{email}}",
      "dob": "{{date '1900' '2000' 'YYYY'}}",
      "address": "{{int 1 100}} {{street}}",
      "city": "{{city}}",
      "optedin": {{boolean}}
    }
    {{/repeat}}
  ],
  "images": [
    {{#repeat 3}}
    "img{{@index}}.png"
    {{/repeat}}
  ],
  "coordinates": {
    "x": {{float -50 50 '0.00'}},
    "y": {{float -25 25 '0.00'}},
    "direction": "{{orientation}}"
  },
  "price": "{{int 0 99999 '0,0'}}",
  "animal": "{{random 'cat' 'dog' 'crow'}}"
}`;

const result = dummyjson.parse(template, { helpers: myHelpers, mockdata: myMockdata });

console.log(result);
